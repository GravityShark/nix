#!/bin/sh

if [ $# -ne 2 ]; then
    echo "Usage: $0 <app-id> <executable>"
    exit 1
fi

APP_ID="$1"
EXECUTABLE="$2"

if ! command -v jq >/dev/null 2>&1; then
    echo "Error: jq is not installed. Please install jq to use this script."
    exit 1
fi

WINDOW_ID=$(niri msg --json windows | jq -r --arg app_id "$APP_ID" '.[] | select(.app_id == $app_id) | .id' | head -n1)

if [ -n "$WINDOW_ID" ]; then
    niri msg action focus-window --id "$WINDOW_ID"
else
    setsid "$EXECUTABLE" &
fi
